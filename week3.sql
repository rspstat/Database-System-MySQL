CREATE DATABASE SPORTS;
USE SPORTS;

CREATE TABLE ADDRESS (
    ADDRESS_ID CHAR(5) NOT NULL,
    ADDRESS_NAME VARCHAR(45) NOT NULL,
    ZIP_CODE INT,
    CONSTRAINT PK_ADDRESS PRIMARY KEY (ADDRESS_ID)
);

CREATE TABLE TEAM (
    TEAM_ID CHAR(5) NOT NULL,
    TEAM_NAME VARCHAR(45) NOT NULL,
    PHONE INT,
    ADDRESS_ID CHAR(5) NOT NULL,
    CONSTRAINT PK_TEAM PRIMARY KEY (TEAM_ID),
    CONSTRAINT FK_TEAM_ADDRESS FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESS(ADDRESS_ID)
);

CREATE TABLE PLAYER (
    PLAYER_ID CHAR(5) NOT NULL,
    PLAYER_NAME VARCHAR(45) NOT NULL,
    PLAYER_NO INT,
    EMAIL VARCHAR(45),
    TEAM_ID CHAR(5) NOT NULL,
    CONSTRAINT PK_PLAYER PRIMARY KEY (PLAYER_ID),
    CONSTRAINT FK_PLAYER_TEAM FOREIGN KEY (TEAM_ID) REFERENCES TEAM(TEAM_ID)
);

ALTER TABLE PLAYER DROP COLUMN EMAIL;
ALTER TABLE TEAM MODIFY PHONE VARCHAR(45);
ALTER TABLE ADDRESS MODIFY ZIP_CODE INT NOT NULL;

INSERT INTO ADDRESS VALUES ('A0001','Korea',1001);
INSERT INTO ADDRESS VALUES ('A0002','England',1002);
INSERT INTO ADDRESS VALUES ('A0003','Spain',1003);
INSERT INTO ADDRESS VALUES ('A0004','Italy',1004);

INSERT INTO TEAM VALUES ('TM011','Arsenal','12345','A0002');
INSERT INTO TEAM VALUES ('TM012','Tottenham','23456','A0002');
INSERT INTO TEAM VALUES ('TM013','Manchester United','34565','A0002');
INSERT INTO TEAM VALUES ('TM014','FC Seoul','34567','A0001');
INSERT INTO TEAM VALUES ('TM015','Barcelona','45678','A0003');
INSERT INTO TEAM VALUES ('TM016','Real Madrid','56789','A0003');
INSERT INTO TEAM VALUES ('TM017','Juventus','67890','A0004');

INSERT INTO PLAYER VALUES ('P0111','Saka',7,'TM011');
INSERT INTO PLAYER VALUES ('P0112','Leno',1,'TM011');
INSERT INTO PLAYER VALUES ('P0113','Son',7,'TM012');
INSERT INTO PLAYER VALUES ('P0114','Ronaldo',7,'TM013');
INSERT INTO PLAYER VALUES ('P0115','Pogba',6,'TM013');
INSERT INTO PLAYER VALUES ('P0116','Park',10,'TM014');
INSERT INTO PLAYER VALUES ('P0117','Pique',3,'TM015');
INSERT INTO PLAYER VALUES ('P0118','Benzema',7,'TM016');
INSERT INTO PLAYER VALUES ('P0119','Dybala',10,'TM017');

SELECT ADDRESS_NAME FROM ADDRESS;
SELECT TEAM_NAME FROM TEAM WHERE TEAM_NAME LIKE '%en%';
SELECT PLAYER_NAME FROM PLAYER WHERE PLAYER_NO IN (7,10);
SELECT COUNT(*) AS NoOfPlayers FROM PLAYER;

SELECT COUNT(*) AS LanguagesInUSA
FROM CountryLanguage
WHERE CountryCode = 'USA';

SELECT COUNT(Language) FROM CountryLanguage;
SELECT COUNT(DISTINCT Language) FROM CountryLanguage;

SELECT Language, COUNT(CountryCode)
FROM CountryLanguage
GROUP BY Language;

SELECT COUNT(*) AS LanguagesInKorea
FROM CountryLanguage
WHERE CountryCode = 'KOR';

SELECT Name
FROM Country
WHERE Continent IN ('Europe','Oceania','Antarctica');

SELECT Name, Population
FROM Country
WHERE Continent = 'Asia'
ORDER BY Population DESC
LIMIT 1;

SELECT Continent, COUNT(Name) AS CountryCount
FROM Country
GROUP BY Continent
HAVING COUNT(Name) >= 5;

SELECT Language, COUNT(CountryCode) AS NumCountries
FROM CountryLanguage
WHERE Percentage >= 50
GROUP BY Language
HAVING COUNT(CountryCode) >= 2
ORDER BY NumCountries DESC;
